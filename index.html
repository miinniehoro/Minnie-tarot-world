<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡πÑ‡∏û‡πà‡∏¢‡∏¥‡∏õ‡∏ã‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏±‡∏Å 4 ‡πÉ‡∏ö</title>
    <style>
        /* CSS ‡πÄ‡∏î‡∏¥‡∏°‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì */
        body {
            font-family: 'Tahoma', sans-serif;
            background: linear-gradient(135deg, #ffc0cb, #ffe4e1);
            margin: 0;
            padding: 10px;
            text-align: center;
            padding-bottom: 90px;
            display: flex;
            flex-direction: column;
            align-items: center; /* ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏∂‡πà‡∏á‡∏Å‡∏•‡∏≤‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏û‡πà‡∏™‡∏ß‡∏¢ */
        }
        
        .no-capture { display: block; }
        h1 { color: #8b0000; font-size: 18px; margin: 10px 0; }
        
        button {
            padding: 8px 20px;
            border-radius: 20px;
            border: none;
            background: #b22222;
            color: white;
            font-size: 14px;
            cursor: pointer;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            margin: 5px;
        }

        /* ‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÉ‡∏´‡∏°‡πà: ‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏û‡πà */
        .selection-area {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 10px;
            max-width: 500px;
            margin-top: 20px;
        }

        .card-back {
            width: 70px;
            height: 110px;
            background: #8b0000;
            border: 2px solid #fff;
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            color: #ffd700;
            transition: 0.3s;
            box-shadow: 0 4px 6px rgba(0,0,0,0.2);
        }

        .card-back:hover {
            transform: translateY(-10px);
            background: #a52a2a;
        }

        .card-back.selected {
            visibility: hidden; /* ‡∏Å‡∏î‡πÅ‡∏•‡πâ‡∏ß‡∏´‡∏≤‡∏¢‡πÑ‡∏õ */
        }

        /* ‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÉ‡∏´‡∏°‡πà: Loading */
        #loading {
            display: none;
            margin-top: 50px;
        }
        .spinner {
            border: 4px solid rgba(255,255,255,0.3);
            border-top: 4px solid #b22222;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

        /* ‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡πÑ‡∏û‡πà (‡∏Ñ‡∏á‡πÄ‡∏î‡∏¥‡∏°‡πÅ‡∏ï‡πà‡∏õ‡∏£‡∏±‡∏ö alignment) */
        .cards-container {
            display: none; /* ‡∏ã‡πà‡∏≠‡∏ô‡πÑ‡∏ß‡πâ‡∏Å‡πà‡∏≠‡∏ô */
            grid-template-columns: 1fr 1fr;
            gap: 8px;
            padding: 6px;
            max-width: 420px;
            margin-top: 10px;
        }

        .card {
            background: #fff;
            padding: 6px;
            border-radius: 8px;
            box-shadow: 0 2px 6px rgba(0,0,0,0.12);
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .card img { width: 100%; border-radius: 6px; }
        .pos-label { font-weight: bold; color: #b22222; font-size: 11px; margin-bottom: 4px; }
        .card h3 { font-size: 12px; margin: 5px 0 2px; color: #b22222; }
        .card p { font-size: 10px; text-align: left; color: #333; line-height: 1.25; margin: 0; }

        .bottom-nav {
            position: fixed;
            bottom: 0; left: 0; width: 100%;
            background: #fff;
            display: flex;
            justify-content: space-around;
            padding: 10px 0;
            box-shadow: 0 -2px 10px rgba(0,0,0,0.1);
            z-index: 1000;
        }
    </style>
</head>
<body>

    <h1 class="no-capture">üîÆ ‡πÑ‡∏û‡πà‡∏¢‡∏¥‡∏õ‡∏ã‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏±‡∏Å 4 ‡πÉ‡∏ö üîÆ</h1>
    
    <div id="instruction" class="no-capture">
        <p>‡∏ï‡∏±‡πâ‡∏á‡∏à‡∏¥‡∏ï‡∏≠‡∏ò‡∏¥‡∏©‡∏ê‡∏≤‡∏ô‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏û‡πà‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£ 4 ‡πÉ‡∏ö</p>
        <p><strong id="count-text">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏•‡πâ‡∏ß: 0/4 ‡πÉ‡∏ö</strong></p>
    </div>

    <!-- ‡πÇ‡∏ã‡∏ô‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏û‡πà -->
    <div class="selection-area" id="selectionArea">
        <!-- ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏û‡πà 12 ‡πÉ‡∏ö‡πÉ‡∏´‡πâ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏û‡∏≠‡πÄ‡∏õ‡πá‡∏ô‡∏û‡∏¥‡∏ò‡∏µ -->
    </div>

    <!-- ‡πÇ‡∏ã‡∏ô Loading -->
    <div id="loading">
        <div class="spinner"></div>
        <p>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏õ‡∏¥‡∏î‡∏Ñ‡∏≥‡∏ó‡∏≥‡∏ô‡∏≤‡∏¢‡πÇ‡∏ä‡∏Ñ‡∏ä‡∏∞‡∏ï‡∏≤‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì...<br>‡πÇ‡∏õ‡∏£‡∏î‡∏£‡∏≠‡∏™‡∏±‡∏Å‡∏Ñ‡∏£‡∏π‡πà</p>
    </div>

    <!-- ‡∏õ‡∏∏‡πà‡∏°‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•‡πÄ‡∏™‡∏£‡πá‡∏à -->
    <div id="after-draw" class="no-capture btn-group" style="display: none;">
        <button onclick="location.reload()">‡∏™‡∏∏‡πà‡∏°‡πÑ‡∏û‡πà‡πÉ‡∏´‡∏°‡πà</button>
        <button onclick="prepareCapture()" style="background: #ad1457;">üì∏ ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡πÅ‡∏Ñ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠</button>
    </div>

    <!-- ‡πÇ‡∏ã‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏• -->
    <div class="cards-container" id="result"></div>

    <nav class="bottom-nav">
        <a href="#" style="text-decoration: none; color: #8b0000; font-size: 11px; display: flex; flex-direction: column; align-items: center;">
            <span>üÉè</span><span>‡πÑ‡∏û‡πà‡∏¢‡∏¥‡∏õ‡∏ã‡∏µ</span>
        </a>
        <a href="javascript:void(0);" onclick="shareWeb()" style="text-decoration: none; color: #8b0000; font-size: 11px; display: flex; flex-direction: column; align-items: center;">
            <span>üì¢</span><span>‡πÅ‡∏ä‡∏£‡πå</span>
        </a>
        <a href="#" style="text-decoration: none; color: #8b0000; font-size: 11px; display: flex; flex-direction: column; align-items: center;">
            <span>üïâÔ∏è</span><span>‡∏°‡∏π‡πÄ‡∏ï‡∏•‡∏π</span>
        </a>
    </nav>

<script>
    const BASE = ""; 
    const positions = ["‡πÉ‡∏ö‡∏ó‡∏µ‡πà 1 : ‡∏ï‡∏±‡∏ß‡∏Ñ‡∏∏‡∏ì", "‡πÉ‡∏ö‡∏ó‡∏µ‡πà 2 : ‡πÄ‡∏Ç‡∏≤", "‡πÉ‡∏ö‡∏ó‡∏µ‡πà 3 : ‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô", "‡πÉ‡∏ö‡∏ó‡∏µ‡πà 4 : ‡∏≠‡∏ô‡∏≤‡∏Ñ‡∏ï"];
    let selectedCount = 0;

    const tarotDeck = [
        /* Major Arcana ‡πÅ‡∏•‡∏∞‡∏ä‡∏∏‡∏î‡∏≠‡∏∑‡πà‡∏ô‡πÜ (‡∏¢‡πà‡∏≠‡πÑ‡∏ß‡πâ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏°‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì) */
        {n:"The Fool",i:"00-TheFool.jpg",m:"‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏±‡∏Å‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÉ‡∏´‡∏°‡πà ‡πÉ‡∏™‡∏ã‡∏∑‡πà‡∏≠ ‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏à ‡πÅ‡∏ï‡πà‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÅ‡∏ô‡πà‡∏ô‡∏≠‡∏ô"},
        {n:"The Magician",i:"01-TheMagician.jpg",m:"‡πÄ‡∏™‡∏ô‡πà‡∏´‡πå‡πÅ‡∏£‡∏á ‡∏î‡∏∂‡∏á‡∏î‡∏π‡∏î‡∏Å‡∏±‡∏ô‡∏î‡πâ‡∏ß‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏£ ‡∏°‡∏µ‡πÇ‡∏≠‡∏Å‡∏≤‡∏™‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏à‡∏£‡∏¥‡∏á‡∏à‡∏±‡∏á"},
        {n:"The High Priestess",i:"02-TheHighPriestess.jpg",m:"‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡∏™‡∏∂‡∏Å‡∏ã‡πà‡∏≠‡∏ô‡∏≠‡∏¢‡∏π‡πà ‡∏ï‡πà‡∏≤‡∏á‡∏ù‡πà‡∏≤‡∏¢‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏à‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î"},
        {n:"The Empress",i:"03-TheEmpress.jpg",m:"‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏±‡∏Å‡∏≠‡∏ö‡∏≠‡∏∏‡πà‡∏ô ‡πÄ‡∏≠‡∏≤‡πÉ‡∏à‡πÉ‡∏™‡πà ‡∏°‡∏µ‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏£‡∏∞‡∏¢‡∏∞‡∏¢‡∏≤‡∏ß"},
        {n:"The Emperor",i:"04-TheEmperor.jpg",m:"‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏±‡∏Å‡∏à‡∏£‡∏¥‡∏á‡∏à‡∏±‡∏á ‡∏°‡∏±‡πà‡∏ô‡∏Ñ‡∏á ‡∏Ñ‡∏ô‡∏ô‡∏µ‡πâ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏î‡∏π‡πÅ‡∏•"},
        {n:"The Hierophant",i:"05-TheHierophant.jpg",m:"‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå‡πÄ‡∏õ‡πá‡∏ô‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£ ‡∏ú‡∏π‡πâ‡πÉ‡∏´‡∏ç‡πà‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô"},
        {n:"The Lovers",i:"06-TheLovers.jpg",m:"‡∏£‡∏±‡∏Å‡πÅ‡∏£‡∏á‡∏î‡∏∂‡∏á‡∏î‡∏π‡∏î‡∏™‡∏π‡∏á ‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô‡πÉ‡∏à‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ã‡∏∑‡πà‡∏≠‡∏™‡∏±‡∏ï‡∏¢‡πå"},
        {n:"The Chariot",i:"07-TheChariot.jpg",m:"‡∏£‡∏±‡∏Å‡πÄ‡∏î‡∏¥‡∏ô‡∏´‡∏ô‡πâ‡∏≤ ‡πÅ‡∏°‡πâ‡∏≠‡∏∏‡∏õ‡∏™‡∏£‡∏£‡∏Ñ ‡πÅ‡∏ï‡πà‡∏¢‡∏±‡∏á‡πÑ‡∏õ‡∏ï‡πà‡∏≠‡πÑ‡∏î‡πâ"},
        {n:"Strength",i:"08-Strength.jpg",m:"‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏≠‡∏î‡∏ó‡∏ô ‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à ‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏≠‡∏≤‡∏£‡∏°‡∏ì‡πå"},
        {n:"The Hermit",i:"09-TheHermit.jpg",m:"‡∏ä‡πà‡∏ß‡∏á‡∏ó‡∏ö‡∏ó‡∏ß‡∏ô‡∏´‡∏±‡∏ß‡πÉ‡∏à ‡∏ï‡πâ‡∏≠‡∏á‡∏≠‡∏¢‡∏π‡πà‡∏Å‡∏±‡∏ö‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á‡∏Å‡πà‡∏≠‡∏ô"},
        {n:"Wheel of Fortune",i:"10-WheelOfFortune.jpg",m:"‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏±‡∏Å‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á‡∏ï‡∏≤‡∏°‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏∞‡πÇ‡∏ä‡∏Ñ‡∏ä‡∏∞‡∏ï‡∏≤"},
        {n:"Justice",i:"11-Justice.jpg",m:"‡∏ï‡πâ‡∏≠‡∏á‡∏à‡∏£‡∏¥‡∏á‡πÉ‡∏à ‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô ‡∏¢‡∏∏‡∏ï‡∏¥‡∏ò‡∏£‡∏£‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ô"},
        {n:"The Hanged Man",i:"12-TheHangedMan.jpg",m:"‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏±‡∏Å‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏£‡∏≠‡∏Ñ‡∏≠‡∏¢ ‡∏´‡∏£‡∏∑‡∏≠‡∏¢‡∏≠‡∏°‡πÄ‡∏™‡∏µ‡∏¢‡∏™‡∏•‡∏∞‡∏ö‡∏≤‡∏á‡∏≠‡∏¢‡πà‡∏≤‡∏á"},
        {n:"Death",i:"13-Death.jpg",m:"‡∏à‡∏ö‡∏™‡∏¥‡πà‡∏á‡πÄ‡∏Å‡πà‡∏≤ ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÉ‡∏´‡∏°‡πà‡∏ó‡∏µ‡πà‡∏î‡∏µ‡∏Å‡∏ß‡πà‡∏≤"},
        {n:"Temperance",i:"14-Temperance.jpg",m:"‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏±‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏ô‡∏µ‡∏õ‡∏£‡∏∞‡∏ô‡∏≠‡∏° ‡∏´‡∏≤‡∏à‡∏∏‡∏î‡∏™‡∏°‡∏î‡∏∏‡∏•"},
        {n:"The Devil",i:"15-TheDevil.jpg",m:"‡∏ú‡∏π‡∏Å‡∏û‡∏±‡∏ô‡∏•‡∏∂‡∏Å ‡∏´‡∏•‡∏á‡πÉ‡∏´‡∏• ‡∏£‡∏∞‡∏ß‡∏±‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå‡πÄ‡∏õ‡πá‡∏ô‡∏û‡∏¥‡∏©"},
        {n:"The Tower",i:"16-TheTower.jpg",m:"‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏â‡∏±‡∏ö‡∏û‡∏•‡∏±‡∏ô ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏£‡∏±‡∏Å‡∏™‡∏±‡πà‡∏ô‡∏Ñ‡∏•‡∏≠‡∏ô"},
        {n:"The Star",i:"17-TheStar.jpg",m:"‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏ß‡∏±‡∏á ‡∏Å‡∏≤‡∏£‡πÄ‡∏¢‡∏µ‡∏¢‡∏ß‡∏¢‡∏≤‡∏´‡∏±‡∏ß‡πÉ‡∏à ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏±‡∏Å‡∏Ñ‡πà‡∏≠‡∏¢‡∏î‡∏µ‡∏Ç‡∏∂‡πâ‡∏ô"},
        {n:"The Moon",i:"18-TheMoon.jpg",m:"‡∏Ñ‡∏ß‡∏≤‡∏°‡∏•‡∏±‡∏á‡πÄ‡∏• ‡πÑ‡∏°‡πà‡πÅ‡∏ô‡πà‡πÉ‡∏à ‡∏£‡∏∞‡∏ß‡∏±‡∏á‡∏Ñ‡∏¥‡∏î‡πÑ‡∏õ‡πÄ‡∏≠‡∏á"},
        {n:"The Sun",i:"19-TheSun.jpg",m:"‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏±‡∏Å‡∏™‡∏î‡πÉ‡∏™ ‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô ‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∏‡∏Ç"},
        {n:"Judgement",i:"20-Judgement.jpg",m:"‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô‡πÉ‡∏à‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç ‡∏≠‡∏î‡∏µ‡∏ï‡∏≠‡∏≤‡∏à‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤"},
        {n:"The World",i:"21-TheWorld.jpg",m:"‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏±‡∏Å‡∏•‡∏á‡∏ï‡∏±‡∏ß ‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå ‡πÅ‡∏•‡∏∞‡∏à‡∏£‡∏¥‡∏á‡∏à‡∏±‡∏á"},
        // (‡∏Ñ‡∏∏‡∏ì‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏™‡πà‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏à‡∏≤‡∏Å‡πÇ‡∏Ñ‡πâ‡∏î‡πÄ‡∏î‡∏¥‡∏°‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà)
    ];

    // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏™‡∏≥‡∏£‡∏±‡∏ö‡πÑ‡∏û‡πà‡∏Ñ‡∏ß‡πà‡∏≥‡∏´‡∏ô‡πâ‡∏≤
    function initGame() {
        const area = document.getElementById("selectionArea");
        for (let i = 0; i < 12; i++) {
            const card = document.createElement("div");
            card.className = "card-back";
            card.innerHTML = "üåô";
            card.onclick = function() { selectCard(this); };
            area.appendChild(card);
        }
    }

    function selectCard(element) {
        if (element.classList.contains('selected')) return;

        element.classList.add('selected');
        selectedCount++;
        document.getElementById('count-text').innerText = `‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏•‡πâ‡∏ß: ${selectedCount}/4 ‡πÉ‡∏ö`;

        if (selectedCount === 4) {
            startProcessing();
        }
    }

    function startProcessing() {
        // 1. ‡∏ã‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏û‡πà
        document.getElementById("selectionArea").style.display = "none";
        document.getElementById("instruction").style.display = "none";

        // 2. ‡πÅ‡∏™‡∏î‡∏á‡∏´‡∏ô‡πâ‡∏≤ Loading
        const loading = document.getElementById("loading");
        loading.style.display = "block";

        // 3. ‡∏£‡∏≠ 5 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ‡πÅ‡∏•‡πâ‡∏ß‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•
        setTimeout(() => {
            loading.style.display = "none";
            displayResults();
        }, 5000); // 5000ms = 5 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
    }

    function displayResults() {
        const box = document.getElementById("result");
        box.innerHTML = "";
        box.style.display = "grid";
        document.getElementById("after-draw").style.display = "block";

        // ‡∏™‡∏∏‡πà‡∏°‡πÑ‡∏û‡πà 4 ‡πÉ‡∏ö‡∏à‡∏≤‡∏Å‡∏™‡∏≥‡∏£‡∏±‡∏ö
        const picks = [...tarotDeck].sort(() => 0.5 - Math.random()).slice(0, 4);

        picks.forEach((c, i) => {
            const el = document.createElement("div");
            el.className = "card";
            el.innerHTML = `
                <span class="pos-label">${positions[i]}</span>
                <img src="${BASE + c.i}" alt="${c.n}" onerror="this.src='https://placehold.co/160x240?text=Not+Found';">
                <h3>${c.n}</h3>
                <p>${c.m}</p>
            `;
            box.appendChild(el);
        });
    }

    function prepareCapture() {
        document.body.classList.add('screenshot-mode');
        setTimeout(() => {
            alert("‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÅ‡∏Ñ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡πÅ‡∏•‡πâ‡∏ß! (‡∏Å‡∏î‡∏ï‡∏Å‡∏•‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏∂‡∏á‡πÄ‡∏°‡∏ô‡∏π‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤)");
            document.body.classList.remove('screenshot-mode');
        }, 300);
    }

    function shareWeb() {
        if (navigator.share) {
            navigator.share({ title: '‡πÑ‡∏û‡πà‡∏¢‡∏¥‡∏õ‡∏ã‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏±‡∏Å 4 ‡πÉ‡∏ö', url: window.location.href });
        } else {
            alert("‡∏Å‡πä‡∏≠‡∏õ‡∏õ‡∏µ‡πâ‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏ô‡∏µ‡πâ‡πÑ‡∏õ‡πÅ‡∏ä‡∏£‡πå: " + window.location.href);
        }
    }

    // ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏Å‡∏°
    initGame();
</script>
</body>
</html>
